(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[193],{1397:function(e,t,r){Promise.resolve().then(r.bind(r,8466))},8466:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var n=r(7437),a=r(7648),s=r(6070),i=r(5974),c=r(2869),o=r(6109),d=r(1671),l=r(9205);let u=(0,l.Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),m=(0,l.Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var f=r(2660),h=r(4766),v=r(2265),g=r(9116),x=r(6023);function p(){var e;let[t,r]=(0,v.useState)(null),[l,p]=(0,v.useState)(!1),[y,b]=(0,v.useState)(null),[w,j]=(0,v.useState)(null),N=(0,x.vF)();(0,v.useEffect)(()=>{(null==N?void 0:N.user_id)&&(p(!0),b(null),(0,g.U2)("/notifications/user/".concat(N.user_id)).then(e=>r(Array.isArray(e)?e:[])).catch(e=>b((null==e?void 0:e.message)||JSON.stringify(e))).finally(()=>p(!1)))},[null==N?void 0:N.user_id]);let k=e=>{switch(e){case"success":return(0,n.jsx)(d.Z,{className:"h-5 w-5 text-secondary"});case"warning":return(0,n.jsx)(u,{className:"h-5 w-5 text-destructive"});default:return(0,n.jsx)(m,{className:"h-5 w-5 text-primary"})}},_=null!==(e=null==t?void 0:t.filter(e=>!e.read).length)&&void 0!==e?e:0;async function S(e){j(e);try{let t=await (0,g.v_)("/notifications/".concat(e,"/read"),{});r(r=>r?r.map(r=>r.notification_id===e?t:r):r)}catch(e){b("Failed to mark notification as read. Please try again."),setTimeout(()=>b(null),3e3)}finally{j(null)}}return(0,n.jsxs)(o.O,{children:[(0,n.jsxs)("header",{className:"bg-primary text-primary-foreground p-6 shadow-md",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,n.jsx)(a.default,{href:"/passenger",className:"hover:opacity-80",children:(0,n.jsx)(f.Z,{className:"h-6 w-6"})}),(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Notifications"})]}),_>0&&(0,n.jsxs)(i.C,{className:"bg-secondary text-secondary-foreground",children:[_," new notification",1!==_?"s":""]})]}),(0,n.jsxs)("div",{className:"p-6 space-y-3",children:[l&&(0,n.jsx)("div",{className:"space-y-3",children:[1,2,3].map(e=>(0,n.jsxs)(s.Zb,{className:"shadow-lg animate-pulse",children:[(0,n.jsx)(s.Ol,{className:"pb-3",children:(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)("div",{className:"w-5 h-5 rounded-full bg-muted"}),(0,n.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,n.jsx)("div",{className:"h-4 bg-muted rounded w-3/4"}),(0,n.jsx)("div",{className:"h-3 bg-muted rounded w-1/4"})]})]})}),(0,n.jsx)(s.aY,{children:(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"h-4 bg-muted rounded"}),(0,n.jsx)("div",{className:"h-4 bg-muted rounded w-5/6"})]})})]},e))}),y&&(0,n.jsx)("div",{className:"p-4 rounded-md bg-destructive/10 border border-destructive/20 text-destructive",children:y}),!l&&t&&0===t.length&&(0,n.jsx)(s.Zb,{className:"shadow-lg",children:(0,n.jsxs)(s.aY,{className:"py-12 text-center",children:[(0,n.jsx)(h.Z,{className:"h-12 w-12 text-muted-foreground mx-auto mb-3"}),(0,n.jsx)("p",{className:"text-muted-foreground",children:"No notifications yet"}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"We'll notify you when something important happens"})]})}),null==t?void 0:t.map(e=>(0,n.jsxs)(s.Zb,{className:"shadow-lg transition-all ".concat(e.read?"":"border-l-4 border-l-primary bg-primary/5"),children:[(0,n.jsx)(s.Ol,{className:"pb-3",children:(0,n.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,n.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[(0,n.jsx)("div",{className:"mt-0.5",children:k(e.type)}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)(s.ll,{className:"text-base",children:e.title}),!e.read&&(0,n.jsx)(i.C,{variant:"secondary",className:"mt-1 text-xs",children:"New"})]})]}),!e.read&&(0,n.jsx)("div",{children:(0,n.jsx)(c.z,{variant:"ghost",size:"sm",onClick:()=>S(e.notification_id),isLoading:w===e.notification_id,loadingText:"Marking...",className:"text-sm text-primary hover:text-primary hover:bg-primary/10",children:"Mark read"})})]})}),(0,n.jsxs)(s.aY,{className:"space-y-2",children:[(0,n.jsx)("p",{className:"text-sm text-foreground",children:e.message}),(0,n.jsx)("p",{className:"text-xs text-muted-foreground",children:e.created_at?new Date(e.created_at).toLocaleString():""})]})]},e.notification_id))]})]})}},6109:function(e,t,r){"use strict";r.d(t,{O:function(){return s}});var n=r(7437),a=r(4508);function s(e){let{children:t,className:r}=e;return(0,n.jsx)("div",{className:(0,a.cn)("min-h-screen bg-background pb-20",r),children:(0,n.jsx)("div",{className:"max-w-md mx-auto",children:t})})}},5974:function(e,t,r){"use strict";r.d(t,{C:function(){return o}});var n=r(7437);r(2265);var a=r(8482),s=r(535),i=r(4508);let c=(0,s.j)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:r,asChild:s=!1,...o}=e,d=s?a.g7:"span";return(0,n.jsx)(d,{"data-slot":"badge",className:(0,i.cn)(c({variant:r}),t),...o})}},2869:function(e,t,r){"use strict";r.d(t,{z:function(){return d}});var n=r(7437);r(2265);var a=r(8482),s=r(535),i=r(1817),c=r(4508);let o=(0,s.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function d(e){let{className:t,variant:r,size:s,asChild:d=!1,isLoading:l=!1,loadingText:u,children:m,...f}=e,h=d?a.g7:"button";return(0,n.jsx)(h,{"data-slot":"button",className:(0,c.cn)(o({variant:r,size:s,className:t}),l&&"cursor-wait","active:scale-95 transition-transform duration-75"),disabled:l||f.disabled,...f,children:l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.Z,{className:"animate-spin"}),u||m]}):m})}},6070:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},SZ:function(){return o},Zb:function(){return s},aY:function(){return d},ll:function(){return c}});var n=r(7437);r(2265);var a=r(4508);function s(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...r})}function i(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...r})}function c(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",t),...r})}function o(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",t),...r})}function d(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",t),...r})}},9116:function(e,t,r){"use strict";r.d(t,{U2:function(){return i},r$:function(){return c},v_:function(){return s}});let n=r(257).env.NEXT_PUBLIC_API_BASE||"https://kadzysakatna.onrender.com";function a(){try{return localStorage.getItem("tricy_token")}catch(e){return null}}async function s(e,t){let r=a(),s={"Content-Type":"application/json"};r&&(s.Authorization="Bearer ".concat(r));let i=await fetch("".concat(n).concat(e),{method:"POST",headers:s,body:JSON.stringify(t)});if(401===i.status){try{localStorage.removeItem("tricy_token"),localStorage.removeItem("tricy_user"),window.dispatchEvent(new CustomEvent("tricy_logout"))}catch(e){}throw{message:"Unauthorized",status:401}}let c=await i.json().catch(()=>null);if(!i.ok)throw c||{message:i.statusText};return c}async function i(e){let t=a(),r={"Content-Type":"application/json"};t&&(r.Authorization="Bearer ".concat(t));let s=await fetch("".concat(n).concat(e),{headers:r});if(401===s.status){try{localStorage.removeItem("tricy_token"),localStorage.removeItem("tricy_user"),window.dispatchEvent(new CustomEvent("tricy_logout"))}catch(e){}throw{message:"Unauthorized",status:401}}let i=await s.json().catch(()=>null);if(!s.ok)throw i||{message:s.statusText};return i}async function c(e,t){let r=a(),s={"Content-Type":"application/json"};r&&(s.Authorization="Bearer ".concat(r));let i=await fetch("".concat(n).concat(e),{method:"PATCH",headers:s,body:JSON.stringify(t)});if(401===i.status){try{localStorage.removeItem("tricy_token"),localStorage.removeItem("tricy_user"),window.dispatchEvent(new CustomEvent("tricy_logout"))}catch(e){}throw{message:"Unauthorized",status:401}}let c=await i.json().catch(()=>null);if(!i.ok)throw c||{message:i.statusText};return c}},6023:function(e,t,r){"use strict";r.d(t,{M8:function(){return i},kS:function(){return s},vF:function(){return a}});var n=r(9116);function a(){let e=localStorage.getItem("tricy_user");return e?JSON.parse(e):null}function s(){localStorage.removeItem("tricy_token"),localStorage.removeItem("tricy_user"),window.dispatchEvent(new CustomEvent("tricy_logout"))}async function i(e){let t=a(),r=null!=e?e:null==t?void 0:t.user_id;if(!r)return null;try{return await (0,n.U2)("/users/".concat(r))}catch(e){return console.error("fetchUserFromApi",e),null}}},4508:function(e,t,r){"use strict";r.d(t,{cn:function(){return s}});var n=r(1994),a=r(3335);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,n.W)(t))}},2660:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9205).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},4766:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9205).Z)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]])},1671:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9205).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},1817:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9205).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},7648:function(e,t,r){"use strict";r.d(t,{default:function(){return a.a}});var n=r(2972),a=r.n(n)}},function(e){e.O(0,[998,972,971,117,744],function(){return e(e.s=1397)}),_N_E=e.O()}]);
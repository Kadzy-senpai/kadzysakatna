(()=>{var e={};e.id=926,e.ids=[926],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7317:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>l}),t(1977),t(5974),t(5866);var r=t(3191),a=t(8716),i=t(7922),n=t.n(i),o=t(5231),d={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);t.d(s,d);let l=["",{children:["bookings",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,1977)),"C:\\kadztricy\\sakatna\\frontend\\app\\bookings\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,5974)),"C:\\kadztricy\\sakatna\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\kadztricy\\sakatna\\frontend\\app\\bookings\\page.tsx"],m="/bookings/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/bookings/page",pathname:"/bookings",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},8537:(e,s,t)=>{Promise.resolve().then(t.bind(t,7927))},7927:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>h});var r=t(326),a=t(7577),i=t(3071),n=t(567),o=t(772),d=t(2631),l=t(7085),c=t(7358);let m=(0,t(2881).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var x=t(7636),u=t(7650),p=t(6824),g=t(2991);function h(){let[e,s]=(0,a.useState)([]),[t,h]=(0,a.useState)(!0),[f,v]=(0,a.useState)(null),j=(0,g.vF)(),b=e=>{switch(e){case"completed":return"bg-secondary text-secondary-foreground";case"ongoing":return"bg-primary text-primary-foreground";case"cancelled":return"bg-destructive text-destructive-foreground";default:return"bg-muted text-muted-foreground"}},N=e=>e?e.charAt(0).toUpperCase()+e.slice(1):"Unknown",y=async e=>{if(confirm("Are you sure you want to cancel this booking?")){v(e);try{await (0,p.v_)(`/bookings/${e}/cancel`,{}),s(s=>s.filter(s=>s.booking_id!==e))}catch(e){alert("Failed to cancel booking"),console.error(e)}finally{v(null)}}},k=async e=>{if(confirm("Mark this ride as completed?")){v(e);try{let t=await (0,p.v_)(`/bookings/${e}/complete`,{}),r=t.booking?.status||"completed";s(s=>s.map(s=>s.booking_id===e?{...s,status:r}:s));try{window.dispatchEvent(new CustomEvent("tricy_booking_updated",{detail:{booking_id:e,status:r}}))}catch(e){}}catch(e){alert("Failed to complete ride"),console.error(e)}finally{v(null)}}};return(0,r.jsxs)(d.O,{children:[(0,r.jsxs)("header",{className:"bg-primary text-primary-foreground p-6 shadow-md",children:[r.jsx("h1",{className:"text-2xl font-bold",children:j?.role==="driver"?"Active Rides":"Booking History"}),r.jsx("p",{className:"text-primary-foreground/90 mt-1",children:j?.role==="driver"?"View and complete your active rides":"View all your rides"})]}),r.jsx("div",{className:"p-6 space-y-4",children:t?(0,r.jsxs)("div",{className:"space-y-3",children:[r.jsx("div",{className:"h-24 bg-muted/30 rounded animate-pulse"}),r.jsx("div",{className:"h-24 bg-muted/30 rounded animate-pulse"})]}):0===e.length?r.jsx("p",{className:"text-center text-muted-foreground",children:"No bookings found."}):(()=>{let s=e.filter(e=>"completed"!==(e?.status||"").toLowerCase()),t=e.filter(e=>"completed"===(e?.status||"").toLowerCase());return(0,r.jsxs)("div",{className:"space-y-6",children:[s.length>0&&(0,r.jsxs)("section",{children:[r.jsx("h2",{className:"text-lg font-bold text-foreground mb-3",children:"Active / In Progress"}),r.jsx("div",{className:"space-y-4",children:s.map(e=>(0,r.jsxs)(i.Zb,{className:"shadow-lg",children:[r.jsx(i.Ol,{className:"pb-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx(i.ll,{className:"text-base",children:e.created_at?new Date(e.created_at).toLocaleTimeString():"—"}),r.jsx(n.C,{className:b(e.status),children:N(e.status)})]})}),(0,r.jsxs)(i.aY,{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 text-sm text-muted-foreground",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[r.jsx(c.Z,{className:"h-4 w-4"}),r.jsx("span",{children:e.created_at?new Date(e.created_at).toLocaleDateString():""})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{children:e.time||""})]})]}),(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[r.jsx(x.Z,{className:"h-4 w-4 text-primary mt-0.5 flex-shrink-0"}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"font-medium text-muted-foreground",children:"Pickup"}),r.jsx("p",{className:"text-foreground",children:e.pickup_location||e.pickup||""})]})]}),(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[r.jsx(u.Z,{className:"h-4 w-4 text-secondary mt-0.5 flex-shrink-0"}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"font-medium text-muted-foreground",children:"Drop-off"}),r.jsx("p",{className:"text-foreground",children:e.dropoff_location||e.dropoff||""})]})]})]}),r.jsx("div",{className:"pt-2 border-t border-border",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Fare"}),(0,r.jsxs)("span",{className:"text-lg font-bold text-foreground",children:["₱",e.fare]})]})}),(0,r.jsxs)("div",{className:"pt-2 flex items-center justify-between",children:["requested"===e.status&&r.jsx(o.z,{variant:"ghost",onClick:()=>y(e.booking_id),isLoading:f===e.booking_id,loadingText:"Cancelling...",className:"text-destructive hover:text-destructive hover:bg-destructive/10",children:"Cancel booking"}),j?.role==="driver"&&"completed"!==e.status&&r.jsx(o.z,{variant:"default",onClick:()=>k(e.booking_id),isLoading:f===e.booking_id,loadingText:"Completing...",className:"ml-auto",children:"Ride completed"})]})]})]},e.booking_id))})]}),s.length>0&&t.length>0&&r.jsx("div",{className:"py-2",children:r.jsx("div",{className:"border-t border-border"})}),t.length>0&&(0,r.jsxs)("section",{children:[r.jsx("h2",{className:"text-lg font-bold text-muted-foreground mb-3",children:"Completed"}),r.jsx("div",{className:"space-y-4",children:t.map(e=>(0,r.jsxs)(i.Zb,{className:"shadow-lg",children:[r.jsx(i.Ol,{className:"pb-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx(i.ll,{className:"text-base",children:e.created_at?new Date(e.created_at).toLocaleTimeString():"—"}),r.jsx(n.C,{className:b(e.status),children:N(e.status)})]})}),(0,r.jsxs)(i.aY,{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 text-sm text-muted-foreground",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[r.jsx(c.Z,{className:"h-4 w-4"}),r.jsx("span",{children:e.created_at?new Date(e.created_at).toLocaleDateString():""})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{children:e.time||""})]})]}),(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[r.jsx(x.Z,{className:"h-4 w-4 text-primary mt-0.5 flex-shrink-0"}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"font-medium text-muted-foreground",children:"Pickup"}),r.jsx("p",{className:"text-foreground",children:e.pickup_location||e.pickup||""})]})]}),(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[r.jsx(u.Z,{className:"h-4 w-4 text-secondary mt-0.5 flex-shrink-0"}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"font-medium text-muted-foreground",children:"Drop-off"}),r.jsx("p",{className:"text-foreground",children:e.dropoff_location||e.dropoff||""})]})]})]}),r.jsx("div",{className:"pt-2 border-t border-border",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Fare"}),(0,r.jsxs)("span",{className:"text-lg font-bold text-foreground",children:["₱",e.fare]})]})})]})]},e.booking_id))})]})]})})()}),r.jsx(l.L,{})]})}},567:(e,s,t)=>{"use strict";t.d(s,{C:()=>d});var r=t(326);t(7577);var a=t(9469),i=t(9360),n=t(7863);let o=(0,i.j)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function d({className:e,variant:s,asChild:t=!1,...i}){let d=t?a.g7:"span";return r.jsx(d,{"data-slot":"badge",className:(0,n.cn)(o({variant:s}),e),...i})}},1977:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(8570).createProxy)(String.raw`C:\kadztricy\sakatna\frontend\app\bookings\page.tsx#default`)}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[637,710,404,648],()=>t(7317));module.exports=r})();